# Install Apache + PHP + PostgreSQL + pgAdmin with Docker

Open up Ubuntu terminal

Navigate to project directory \
  `cd /home/$USER/apache-php`

Build apache-php docker image \
  `docker build -t apache-php .`

Install & run apache-php docker container \
  `docker run --name apache-php -d -p 8080:80 apache-php`

Install & run PostgreSQL + PostGIS \
  `docker run --name postgresql -e POSTGRES_PASSWORD=mysecretpassword -d mdillon/postgis`

Install pgAdmin \
  `docker run --name pgadmin --link postgres:postgres -p 5050:5050 -d fenglc/pgadmin4`

`--name` parameter defines the name for running container. You can run as many parallel services as your like as long you give them unique names.
If you don't give the container name at all, docker will give one for you.


### Usage

* What's my web address and port?
```
# Inspect apache-php
docker inspect apache-php

# locate parameters:
# IP aadress: HostConfig -> PortBindings -> HostIp  or  NetworkSettings -> Networks -> bridge -> IPAddress
# Port:       HostConfig -> PortBindings -> HostPort
```

* What's my database host, port, name, user and password?
```
# Inspect postgresql
docker inspect postgresql

# locate parameters:
# host:      NetworkSettings -> Networks -> bridge -> IPAddress
# port:      NetworkSettings -> Ports
# database:  Config -> Env -> POSTGRES_DB
# username:  Config -> Env -> POSTGRES_USER
# password:  Config -> Env -> POSTGRES_PASSWORD
```

* What's my website and database ip address and port if i want to access them from windows?
```
# Inspect Ubuntu IP config
/sbin/ifconfig

# Locate exposed Ip aadress from there.
# It should look something like that:
# ens33     inet addr:192.168.182.132
# You ports should still be the same as on Ubuntu.
# Defaults are 8080 for web server and 5432 for PostgreSQL
```

* How to copy files into apache-php docker container?
```
docker cp -a /home/$USER/apache-php/www/ apache-php:/var/www/html/
```

* How to browse apache-php docker container files & directories
```
docker exec apache-php ls /var/www/html/
```

* How to start/stop web server and database?
```
# Start
docker start apache-php
docker start postrgres
docker start pgadmin

# Stop
docker stop apache-php
docker stop postrgres
docker stop pgadmin

# Inspect container
docker inspect apache-php

# List all docker containers
docker ps -a

# Remove docker container
docker rm apache-php

# Remove docker image
docker rmi apache-php
```

[Return to index](01.Index.md)
